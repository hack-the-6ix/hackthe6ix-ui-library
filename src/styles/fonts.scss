$_: (
  'Avenir': (
    fallback: sans-serif,
    sources: (
      (
        style: normal,
        weight: 400,
        src: (
          embedded-opentype: 'avenir-next-regular.eot',
          truetype: 'avenir-next-regular.ttf',
          woff: 'avenir-next-regular.woff',
          svg: 'avenir-next-regular.svg',
        ),
      ),
      (
        style: normal,
        weight: 600,
        src: (
          embedded-opentype: 'avenir-next-medium.eot',
          truetype: 'avenir-next-medium.ttf',
          woff: 'avenir-next-medium.woff',
          svg: 'avenir-next-medium.svg',
        ),
      ),
      (
        style: normal,
        weight: 200,
        src: (
          embedded-opentype: 'avenir-next-bold.eot',
          truetype: 'avenir-next-bold.ttf',
          woff: 'avenir-next-bold.woff',
          svg: 'avenir-next-bold.svg',
        ),
      ),
    ),
  ),
);

@function _load($sources, $path) {
  $res: '';
  @each $type, $url in map-get($sources, src) {
    $res: #{$res} #{if($res == '', '', ',')} url('#{$path}#{$url}') format('#{$type}');
  }
  @return $res;
}

@mixin load ($path: '/') {
  @each $tag, $config in $_ {
    @each $source in map-get($config, sources) {
      @font-face {
        font-weight: map-get($source, weight);
        font-style: map-get($source, style);
        src: _load($source, $path);
        font-family: '#{$tag}';
        font-display: swap;
      }
    }
  }
}

@function font-family($name) {
  $config: map-get($_, $name);
  @return "#{$name}", map-get($config, fallback);
}